<% provide(:title, 'マップから探す') %>

<div class="container-fluid">
  <div id="map-search-wrapper" class="row content-wrapper">
    <div class="col-xs-12">
      <h1>マップから探す</h1>
    </div>
    <div class=" col-xs-12">
      <div id="search-map"></div>
    </div>
    <div class=" col-xs-12 col-md-10 col-md-offset-1 col-lg-8 col-lg-offset-2">
      <%= form_with scope: :lat_lng, url: root_path, method: :get do |f| %>
        <%= f.number_field :latitude, id: 'lat', step: '0.0000001', value: @latitude, type: 'hidden' %>
        <%= f.number_field :longitude, id: 'lng', step: '0.0000001', value: @longitude, type: 'hidden' %>
        <%= f.submit "周辺の飲食店を探す", class: "btn btn-map-search" %>
      <% end %>
    </div>
    <% if @restaurant.present? %>
      <div class="restaurants col-xs-12 col-md-10 col-md-offset-1 col-lg-8 col-lg-offset-2">
          <% @restaurants.each do |restaurant| %>
          <div class="row">
            <%#= link_to "", @restaurants, class: "stretched-link", data: { 'turbolinks': false }  %>
            <!--<%# if maps_path? %>-->
            <!--  <div id="result-label-<%#= "#{shop_counter+1}" %>" class="col-xs-1"></div>-->
            <!--<%# end %>-->
            <div class="restaurant-name col-xs-12">
              <%= restaurant.name %>
            </div>
            <div class="features col-xs-12">
              <%#= render partial: 'shared/features', collection: shop.features, as: 'feature' %>
            </div>
            <div class="col-xs-12 col-md-8">
              <%= image_tag restaurant.get_image(200,200), id: "img_prev", class: "admin_item_image" %>
            </div>
            <div class="col-xs-12 col-md-4">
              <dl>
                <dt>住所</dt>
                <dd><%= restaurant.address %></dd>
                <dt>営業時間</dt>
                <dd><%= restaurant.business_time %></dd>
                <dt>定休日</dt>
                <dd><%#= @restaurant.closed %></dd>
              </dl>
            </div>
          <% end %>
        </div>

        <%#= render partial: 'restaurants/shop', collection: @restaurant, as: 'restaurant' %>
      </div>
    <% else %>
      <div class="not-found col-xs-12">
        <h4>条件に合う飲食店がありません</h4>
      </div>
    <% end %>
  </div>
</div>
<%= javascript_include_tag "search_map.js" %>
<script src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['API_KEY'] %>&callback=initMap" async defer></script>


